<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NoxKuu | Digital Art</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts: Poppins, Permanent Marker, & Caveat -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Caveat:wght@500;700&family=Permanent+Marker&family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <script>
        // Tailwind dark mode configuration
        tailwind.config = {
            darkMode: 'class',
        }
    </script>

    <style>
        /* Base styles for light mode */
        body {
            font-family: 'Poppins', sans-serif;
            --bg-color: #fdf8f6; /* Pastel Cream */
            --text-color: #57534e; /* Stone 600 */
            --header-bg: rgba(253, 248, 246, 0.8);
            --border-color: #e7e5e4; /* Stone 200 */
            --accent-color: #a78bfa; /* Violet 400 */
            --accent-hover-color: #8b5cf6; /* Violet 500 */
            --inactive-filter-bg: #ffffff;
            --inactive-filter-hover-bg: #f5f5f4; /* Stone 100 */
            @apply transition-colors duration-300;
        }

        /* Dark mode overrides */
        .dark body {
            --bg-color: #1c1917; /* Stone 900 */
            --text-color: #d6d3d1; /* Stone 300 */
            --header-bg: rgba(28, 25, 23, 0.8);
            --border-color: #44403c; /* Stone 700 */
            --accent-color: #a78bfa; /* Violet 400 */
            --accent-hover-color: #c4b5fd; /* Violet 300 */
            --inactive-filter-bg: #292524; /* Stone 800 */
            --inactive-filter-hover-bg: #44403c; /* Stone 700 */
        }
        
        /* Font variables */
        .font-heading {
            font-family: 'Permanent Marker', cursive;
        }
        .font-body-alt {
            font-family: 'Caveat', cursive;
        }

        /* Applying the CSS variables */
        body {
            background-color: var(--bg-color);
            color: var(--text-color);
        }
        .bg-header { background-color: var(--header-bg); }
        .border-themed { border-color: var(--border-color); }
        .text-accent { color: var(--accent-color); }
        .bg-accent { background-color: var(--accent-color); }
        .hover-bg-accent:hover { background-color: var(--accent-hover-color); }
        .bg-inactive-filter { background-color: var(--inactive-filter-bg); }
        .hover-bg-inactive-filter:hover { background-color: var(--inactive-filter-hover-bg); }


        /* Masonry layout for gallery */
        .gallery-masonry { column-gap: 1.5rem; }
        @media (min-width: 640px) { .gallery-masonry { column-count: 2; } }
        @media (min-width: 1024px) { .gallery-masonry { column-count: 3; } }
        .gallery-item { break-inside: avoid; margin-bottom: 1.5rem; }
        
        /* Modal styles */
        .modal-bg { background-color: rgba(253, 248, 246, 0.9); }
        .dark .modal-bg { background-color: rgba(28, 25, 23, 0.9); }
    </style>
</head>
<body class="overflow-x-hidden">

    <!-- =================================================================
    HEADER
    ================================================================== -->
    <header class="fixed top-0 left-0 right-0 z-50 bg-header backdrop-blur-md border-b border-themed">
        <div class="container mx-auto px-6 py-4 flex justify-between items-center">
            <a href="#" id="homeLink" class="text-2xl font-bold tracking-wider text-stone-800 dark:text-white font-heading">NOXKUU</a>
            <div class="flex items-center gap-4">
                <button id="theme-toggle" class="p-2 rounded-full text-stone-500 dark:text-stone-400 hover:bg-stone-100 dark:hover:bg-stone-800 focus:outline-none">
                    <svg id="theme-toggle-light-icon" class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path></svg>
                    <svg id="theme-toggle-dark-icon" class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path></svg>
                </button>
                <a href="https://forms.gle/your-google-form-link" target="_blank" class="bg-accent hover-bg-accent text-white font-bold py-2 px-4 rounded-lg transition-colors duration-300 font-body-alt text-lg">Suggest a Drawing</a>
            </div>
        </div>
    </header>

    <!-- =================================================================
    MAIN CONTENT (Landing Page)
    ================================================================== -->
    <div id="main-content">
        <main>
            <!-- Hero Section -->
            <section class="text-center pt-32 pb-16 md:pt-48 md:pb-24 px-4">
                <div class="z-10">
                    <h1 class="font-heading text-5xl md:text-7xl lg:text-8xl font-bold text-stone-800 dark:text-white tracking-normal">
                        Illustrating Cool Ideas.
                    </h1>
                    <p class="font-body-alt mt-4 text-2xl md:text-3xl text-stone-500 dark:text-stone-400 max-w-2xl mx-auto">
                        A digital gallery exploring characters and concepts from across the imagination.
                    </p>
                </div>
            </section>

            <!-- Recent Work Section -->
            <section id="recent-work" class="py-20 md:py-32 bg-white dark:bg-[#111111]">
                <div class="container mx-auto px-6">
                    <h2 class="font-heading text-4xl md:text-5xl font-bold text-center mb-12 text-stone-800 dark:text-white">
                        Recent <span class="text-accent">Work</span>
                    </h2>
                    <div id="recent-gallery-container" class="gallery-masonry">
                        <!-- Recent gallery items will be dynamically inserted here -->
                    </div>
                    <div class="text-center mt-16">
                        <button id="view-full-gallery-btn" class="bg-accent hover-bg-accent text-white font-bold py-3 px-8 rounded-lg text-lg transition-colors duration-300 font-body-alt text-2xl">
                            View Full Gallery
                        </button>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- =================================================================
    FULL GALLERY PAGE (hidden by default)
    ================================================================== -->
    <div id="gallery-page" class="hidden">
        <section class="py-24 md:py-32">
            <div class="container mx-auto px-6">
                <h2 class="font-heading text-4xl md:text-5xl font-bold text-center mb-4 text-stone-800 dark:text-white">
                    Full <span class="text-accent">Gallery</span>
                </h2>
                <p class="text-center text-stone-500 dark:text-stone-400 mb-12">Filter by universe</p>

                <!-- Filter Buttons -->
                <div id="filter-buttons" class="flex flex-wrap justify-center gap-2 md:gap-4 mb-12">
                    <!-- Filter buttons will be dynamically inserted here -->
                </div>

                <div id="full-gallery-container" class="gallery-masonry">
                    <!-- Full gallery will be dynamically inserted here -->
                </div>
            </div>
        </section>
    </div>
    
    <!-- =================================================================
    FOOTER
    ================================================================== -->
    <footer id="contact" class="bg-stone-800 dark:bg-black py-12">
        <div class="container mx-auto px-6 text-center text-stone-400">
            <p class="font-heading text-3xl font-bold tracking-wider text-white mb-4">NOXKUU</p>
            <div class="flex justify-center mb-8">
                <a href="https://instagram.com/noxkuuart" target="_blank" class="flex items-center space-x-2 text-stone-300 hover:text-white transition-colors duration-300">
                    <svg class="w-8 h-8" fill="currentColor" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M12.315 2c-4.013 0-4.484.018-6.058.087C4.603 2.158 3.597 2.478 2.78 3.294S1.157 4.6 1.087 6.26c-.07 1.574-.087 2.045-.087 6.058s.018 4.484.087 6.058C1.157 20.097 1.478 21.102 2.294 21.92s1.492 1.134 3.155 1.204C6.83 23.182 7.302 23.2 11.315 23.2s4.484-.018 6.058-.087c1.662-.07 2.668-.39 3.484-1.204s1.134-1.492 1.204-3.155c.07-1.574.087-2.045.087-6.058s-.018-4.484-.087-6.058C23.242 4.603 22.922 3.597 22.106 2.78S21.097 1.478 19.434 1.408C17.86 1.34 17.39 1.322 13.315 1.322H12.315zM12 7.045c-2.73 0-4.955 2.225-4.955 4.955S9.27 16.955 12 16.955s4.955-2.225 4.955-4.955S14.73 7.045 12 7.045zm0 8.084c-1.728 0-3.129-1.4-3.129-3.129s1.4-3.129 3.129-3.129 3.129 1.4 3.129 3.129-1.4 3.129-3.129 3.129zM18.883 6.13a1.47 1.47 0 100-2.94 1.47 1.47 0 000 2.94z" clip-rule="evenodd" /></svg>
                    <span>@noxkuuart</span>
                </a>
            </div>
            <p class="text-stone-500 text-sm">&copy; <span id="year"></span> Noxkuu.com. All rights reserved.</p>
        </div>
    </footer>

    <!-- =================================================================
    MODAL
    ================================================================== -->
    <div id="imageModal" class="fixed top-0 left-0 w-full h-full modal-bg items-center justify-center p-4 z-[100] hidden">
        <div class="relative w-full max-w-7xl h-full flex flex-col md:flex-row items-center justify-center gap-8">
            <!-- Main Image Display -->
            <div class="relative w-full md:w-2/3 h-full flex items-center justify-center">
                <button id="prevBtn" class="absolute left-0 text-stone-700 dark:text-stone-200 text-4xl p-2 rounded-full bg-white/50 dark:bg-black/30 hover:bg-white/80 dark:hover:bg-black/50 transition-colors">
                    &#10094;
                </button>
                <img id="modalImage" src="" alt="Full-size artwork" class="max-w-full max-h-[90vh] object-contain rounded-lg shadow-2xl">
                <button id="nextBtn" class="absolute right-0 text-stone-700 dark:text-stone-200 text-4xl p-2 rounded-full bg-white/50 dark:bg-black/30 hover:bg-white/80 dark:hover:bg-black/50 transition-colors">
                    &#10095;
                </button>
            </div>
            <!-- Character Lore Panel -->
            <div class="w-full md:w-1/3 h-auto md:h-full flex flex-col justify-center text-left p-4">
                <button id="closeModalBtn" class="absolute top-0 right-0 p-2 z-[110] rounded-full hover:bg-black/10 dark:hover:bg-white/10 transition-colors">
                    <span class="text-stone-800 dark:text-white text-5xl font-bold cursor-pointer leading-none">&times;</span>
                </button>
                <div id="lore-panel" class="bg-white dark:bg-stone-800/50 p-6 rounded-lg shadow-lg border border-themed h-full overflow-y-auto">
                    <h3 class="font-heading text-3xl text-stone-800 dark:text-white">Character Lore</h3>
                    <div id="lore-container" class="mt-4 text-stone-600 dark:text-stone-300 space-y-2 leading-relaxed">
                        <!-- AI responses will be injected here -->
                    </div>
                </div>
            </div>
        </div>
    </div>


    <!-- =================================================================
    JAVASCRIPT LOGIC
    ================================================================== -->
    <script>
        // --- DOM ELEMENTS ---
        const themeToggleBtn = document.getElementById('theme-toggle');
        const homeLink = document.getElementById('homeLink');
        const mainContent = document.getElementById('main-content');
        const galleryPage = document.getElementById('gallery-page');
        const viewFullGalleryBtn = document.getElementById('view-full-gallery-btn');
        const recentGalleryContainer = document.getElementById('recent-gallery-container');
        const fullGalleryContainer = document.getElementById('full-gallery-container');
        const filterButtonsContainer = document.getElementById('filter-buttons');
        const modal = document.getElementById('imageModal');
        const closeModalBtn = document.getElementById('closeModalBtn');
        const modalImg = document.getElementById('modalImage');
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');
        const loreContainer = document.getElementById('lore-container');

        let galleryImagesForModal = [];
        let currentImageIndex;
        let ALL_ARTWORK = []; 
        let CATEGORIES = []; 
        let currentArtworkInModal;

        // --- GEMINI API FUNCTION ---
        async function getGeminiTextResponse(prompt) {
            const apiKey = ""; // Leave blank
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;
            const payload = { contents: [{ parts: [{ text: prompt }] }] };

            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                if (!response.ok) {
                   throw new Error(`API call failed with status: ${response.status}`);
                }
                const result = await response.json();

                if (result.candidates && result.candidates[0].content && result.candidates[0].content.parts[0]) {
                    return result.candidates[0].content.parts[0].text;
                } else {
                    console.error('Invalid response structure from Gemini API:', result);
                    return "Could not retrieve lore at this time.";
                }
            } catch (error) {
                console.error('Error calling Gemini API:', error);
                return "An error occurred while contacting the AI. Please try again later.";
            }
        }
        
        async function fetchAndDisplayLore(artwork) {
            if (artwork.category === 'original') {
                loreContainer.innerHTML = '<p class="font-body-alt text-xl">A unique creation by NoxKuu.</p>';
                return;
            }

            loreContainer.innerHTML = '<p class="animate-pulse font-body-alt text-xl">Fetching lore from the archives...</p>';
            
            const prompt = `Directly provide a brief, interesting lore snippet (under 80 words) for the following character: ${artwork.flavorText || artwork.alt}. Do not add any introductory phrases like "Certainly, here is the lore...". Just provide the lore itself. Focus on their origin or a key defining trait.`;
            const loreText = await getGeminiTextResponse(prompt);
            
            loreContainer.innerHTML = `<p class="font-body-alt text-xl leading-relaxed">${loreText}</p>`;
        }
        

        // --- CORE FUNCTIONS ---
        const createGalleryItem = (artwork) => {
            const img = document.createElement('img');
            img.src = artwork.src;
            img.alt = artwork.alt;
            img.className = 'rounded-lg border border-themed hover:border-violet-300 dark:hover:border-violet-500 transition-all duration-300 cursor-pointer w-full';
            img.onclick = () => openModal(img, Array.from(img.closest('.gallery-masonry').querySelectorAll('.gallery-item:not([style*="display: none"]) img')), artwork);
            
            const itemDiv = document.createElement('div');
            itemDiv.className = 'gallery-item';
            itemDiv.setAttribute('data-category', artwork.category);
            itemDiv.appendChild(img);
            return itemDiv;
        };

        const populateGalleries = () => {
            recentGalleryContainer.innerHTML = '';
            ALL_ARTWORK.slice(0, 6).forEach(art => recentGalleryContainer.appendChild(createGalleryItem(art)));
            fullGalleryContainer.innerHTML = '';
            ALL_ARTWORK.forEach(art => fullGalleryContainer.appendChild(createGalleryItem(art)));
        };

        const createFilterButtons = () => {
            filterButtonsContainer.innerHTML = ''; // Clear previous buttons
            CATEGORIES.forEach(cat => {
                const button = document.createElement('button');
                button.textContent = cat;
                button.className = 'filter-btn px-4 py-2 text-sm md:text-base font-semibold rounded-lg transition-colors duration-200';
                button.dataset.filter = cat.toLowerCase().replace(/\s+/g, '-');
                if (cat === 'All') {
                    button.classList.add('bg-accent', 'text-white');
                } else {
                    button.classList.add('bg-inactive-filter', 'hover-bg-inactive-filter');
                }
                filterButtonsContainer.appendChild(button);
            });
        };

        const filterGallery = (filter) => {
            fullGalleryContainer.querySelectorAll('.gallery-item').forEach(item => {
                item.style.display = (filter === 'all' || item.dataset.category === filter) ? 'block' : 'none';
            });
        };

        const showPage = (pageToShow) => {
            mainContent.style.display = pageToShow === 'main' ? 'block' : 'none';
            galleryPage.style.display = pageToShow === 'gallery' ? 'block' : 'none';
            window.scrollTo(0, 0);
        };

        const applyTheme = (theme) => {
            const lightIcon = document.getElementById('theme-toggle-light-icon');
            const darkIcon = document.getElementById('theme-toggle-dark-icon');
            if (theme === 'dark') {
                document.documentElement.classList.add('dark');
                lightIcon.style.display = 'block';
                darkIcon.style.display = 'none';
            } else {
                document.documentElement.classList.remove('dark');
                lightIcon.style.display = 'none';
                darkIcon.style.display = 'block';
            }
        };

        const openModal = (element, galleryNodeList, artworkData) => {
            currentArtworkInModal = artworkData;
            galleryImagesForModal = galleryNodeList;
            modal.style.display = 'flex';
            modalImg.src = element.src;
            currentImageIndex = galleryImagesForModal.findIndex(img => img.src === element.src);
            document.body.style.overflow = 'hidden';

            fetchAndDisplayLore(currentArtworkInModal);
        };

        const closeModal = () => {
            modal.style.display = 'none';
            document.body.style.overflow = '';
        };

        const changeImage = (direction) => {
            currentImageIndex = (currentImageIndex + direction + galleryImagesForModal.length) % galleryImagesForModal.length;
            const newImgSrc = galleryImagesForModal[currentImageIndex].src;
            modalImg.src = newImgSrc;
            
            // Find new artwork data and fetch lore
            currentArtworkInModal = ALL_ARTWORK.find(art => art.src === newImgSrc);
            fetchAndDisplayLore(currentArtworkInModal);
        };
        

        // --- INITIALIZATION ---
        document.addEventListener('DOMContentLoaded', () => {
            document.getElementById('year').textContent = new Date().getFullYear();
            
            // Using a placeholder JSON for now. Replace with your actual gallery-data.json
            const placeholderData = {
                artwork: [
                    { src: 'https://placehold.co/600x800/e2e8f0/64748b?text=Phoenix', alt: 'Artwork of Phoenix', category: 'marvel', flavorText: 'Jean Grey as the cosmic entity Dark Phoenix' },
                    { src: 'https://placehold.co/600x600/e2e8f0/64748b?text=Daredevil', alt: 'Artwork of Daredevil', category: 'marvel', flavorText: 'Matt Murdock, the Daredevil of Hell\'s Kitchen' },
                    { src: 'https://placehold.co/600x750/e2e8f0/64748b?text=Moon+Knight', alt: 'Artwork of Moon Knight', category: 'marvel', flavorText: 'Marc Spector, the avatar of the Egyptian moon god Khonshu' },
                    { src: 'https://placehold.co/600x900/e2e8f0/64748b?text=Cassandra+Cain', alt: 'Artwork of Cassandra Cain', category: 'dc', flavorText: 'Cassandra Cain as Batgirl, one of the world\'s greatest martial artists' },
                    { src: 'https://placehold.co/600x700/e2e8f0/64748b?text=Superboy', alt: 'Artwork of Superboy', category: 'dc', flavorText: 'Kon-El, the clone of Superman from the Young Justice storyline' },
                    { src: 'https://placehold.co/600x850/e2e8f0/64748b?text=Jedi', alt: 'Artwork of a Jedi', category: 'star-wars', flavorText: 'A Jedi Knight from the Star Wars Old Republic era' },
                    { src: 'https://placehold.co/600x780/e2e8f0/64748b?text=Original+1', alt: 'Original character concept', category: 'original', flavorText: '' },
                    { src: 'https://placehold.co/600x650/e2e8f0/64748b?text=Original+2', alt: 'Original creature design', category: 'original', flavorText: '' },
                ]
            };
            
            fetch('./gallery-data.json')
                .then(response => response.ok ? response.json() : placeholderData)
                .then(data => {
                    ALL_ARTWORK = data.artwork;
                    const uniqueCategories = ['All', ...new Set(ALL_ARTWORK.map(art => art.category.charAt(0).toUpperCase() + art.category.slice(1).replace(/-/g, ' ')))];
                    CATEGORIES = uniqueCategories;
                    
                    populateGalleries();
                    createFilterButtons();

                    filterButtonsContainer.addEventListener('click', (e) => {
                        if (e.target.classList.contains('filter-btn')) {
                            document.querySelectorAll('.filter-btn').forEach(btn => {
                                btn.classList.remove('bg-accent', 'text-white');
                                btn.classList.add('bg-inactive-filter', 'hover-bg-inactive-filter');
                            });
                            e.target.classList.add('bg-accent', 'text-white');
                            e.target.classList.remove('bg-inactive-filter', 'hover-bg-inactive-filter');
                            filterGallery(e.target.dataset.filter);
                        }
                    });
                }).catch(error => {
                    console.error('Error initializing gallery:', error);
                    ALL_ARTWORK = placeholderData.artwork;
                    const uniqueCategories = ['All', ...new Set(ALL_ARTWORK.map(art => art.category.charAt(0).toUpperCase() + art.category.slice(1).replace(/-/g, ' ')))];
                    CATEGORIES = uniqueCategories;
                    populateGalleries();
                    createFilterButtons();
                });
            
            const savedTheme = localStorage.getItem('theme') || 'light';
            applyTheme(savedTheme);

            viewFullGalleryBtn.addEventListener('click', () => showPage('gallery'));
            homeLink.addEventListener('click', (e) => { e.preventDefault(); showPage('main'); });
            themeToggleBtn.addEventListener('click', () => {
                const newTheme = document.documentElement.classList.contains('dark') ? 'light' : 'dark';
                localStorage.setItem('theme', newTheme);
                applyTheme(newTheme);
            });
            
            closeModalBtn.addEventListener('click', closeModal);
            modal.addEventListener('click', (e) => { if (e.target === modal) closeModal(); });
            prevBtn.addEventListener('click', (e) => { e.stopPropagation(); changeImage(-1); });
            nextBtn.addEventListener('click', (e) => { e.stopPropagation(); changeImage(1); });
            document.addEventListener('keydown', (e) => {
                if (modal.style.display === 'flex') {
                    if (e.key === 'Escape') closeModal();
                    if (e.key === 'ArrowLeft') changeImage(-1);
                    if (e.key === 'ArrowRight') changeImage(1);
                }
            });
        });
    </script>
</body>
</html>
